<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>妈妈的话</title>
  <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
  <link rel="stylesheet" href="./css/talk.css">
</head>
<body>
  <div class="momPage">
    <div class="momHero">
      <div class="heroIcon">
        <ion-icon name="heart"></ion-icon>
      </div>
      <div class="heroInfo">
        <h1 class="heroTitle">妈妈的话</h1>
        <p class="heroSubtitle">记录温暖，珍藏时光</p>
      </div>
      <div class="heroDecor">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>

    <div class="momGallery">
      <div class="galleryItem" onclick="openLightbox('./png/two.png', '温馨时刻')">
        <div class="itemImage">
          <img src="./png/two.png" alt="温馨时刻">
        </div>
        <div class="itemOverlay">
          <ion-icon name="expand-outline"></ion-icon>
        </div>
        <div class="itemLabel">
          <span class="labelDot"></span>
          <span class="labelText">温馨时刻</span>
        </div>
      </div>

      <div class="galleryItem" onclick="openLightbox('./png/wxr.png', '幸福瞬间')">
        <div class="itemImage">
          <img src="./png/wxr.png" alt="幸福瞬间">
        </div>
        <div class="itemOverlay">
          <ion-icon name="expand-outline"></ion-icon>
        </div>
        <div class="itemLabel">
          <span class="labelDot"></span>
          <span class="labelText">幸福瞬间</span>
        </div>
      </div>

      <div class="galleryItem" onclick="openLightbox('./png/eat.png', '美味时光')">
        <div class="itemImage">
          <img src="./png/eat.png" alt="美味时光">
        </div>
        <div class="itemOverlay">
          <ion-icon name="expand-outline"></ion-icon>
        </div>
        <div class="itemLabel">
          <span class="labelDot"></span>
          <span class="labelText">美味时光</span>
        </div>
      </div>
    </div>

    <div class="momFooter">
      <ion-icon name="leaf"></ion-icon>
      <span>用心记录每一刻</span>
      <ion-icon name="leaf"></ion-icon>
    </div>
  </div>

  <div class="lightbox" id="lightbox" onclick="closeLightbox(event)">
    <div class="lightboxContent">
      <button class="lightboxClose" onclick="closeLightbox(event)">
        <ion-icon name="close"></ion-icon>
      </button>
      
      <div class="lightboxImageWrap">
        <img src="" alt="" id="lightboxImage">
      </div>
      
      <div class="lightboxCaption" id="lightboxCaption"></div>
      
      <button class="lightboxNav lightboxPrev" onclick="changeImage(-1, event)">
        <ion-icon name="chevron-back"></ion-icon>
      </button>
      <button class="lightboxNav lightboxNext" onclick="changeImage(1, event)">
        <ion-icon name="chevron-forward"></ion-icon>
      </button>
      
      <div class="lightboxControls">
        <button onclick="zoomImage(-0.2, event)">
          <ion-icon name="remove"></ion-icon>
        </button>
        <span id="zoomLevel">100%</span>
        <button onclick="zoomImage(0.2, event)">
          <ion-icon name="add"></ion-icon>
        </button>
        <button onclick="resetZoom(event)">
          <ion-icon name="refresh"></ion-icon>
        </button>
      </div>
    </div>
  </div>

  <div class="themeToggle" id="themeToggle">
    <div class="toggleTrack">
      <div class="toggleSun">
        <ion-icon name="sunny-outline"></ion-icon>
      </div>
      <div class="toggleMoon">
        <ion-icon name="moon-outline"></ion-icon>
      </div>
      <div class="toggleThumb"></div>
    </div>
    <div class="toggleGlow"></div>
  </div>

  <canvas id="snowCanvas"></canvas>
  <div class="snowThemePanel" id="snowThemePanel">
    <div class="snowThemeToggle" id="snowThemeToggle">
      <ion-icon name="snow-outline"></ion-icon>
    </div>
    <div class="snowThemeList">
      <div class="snowThemeItem" data-theme="winter">
        <div class="themePreview winter">
          <span></span><span></span><span></span>
        </div>
        <span class="themeName">冬日白雪</span>
      </div>
      <div class="snowThemeItem" data-theme="romantic">
        <div class="themePreview romantic">
          <span></span><span></span><span></span>
        </div>
        <span class="themeName">浪漫粉色</span>
      </div>
      <div class="snowThemeItem" data-theme="rainbow">
        <div class="themePreview rainbow">
          <span></span><span></span><span></span>
        </div>
        <span class="themeName">梦幻彩虹</span>
      </div>
      <div class="snowThemeItem" data-theme="christmas">
        <div class="themePreview christmas">
          <span></span><span></span><span></span>
        </div>
        <span class="themeName">金色圣诞</span>
      </div>
      <div class="snowThemeItem" data-theme="aurora">
        <div class="themePreview aurora">
          <span></span><span></span><span></span>
        </div>
        <span class="themeName">极光之夜</span>
      </div>
      <div class="snowThemeItem" data-theme="sakura">
        <div class="themePreview sakura">
          <span></span><span></span><span></span>
        </div>
        <span class="themeName">樱花飘落</span>
      </div>
      <div class="snowThemeItem" data-theme="none">
        <div class="themePreview none">
          <ion-icon name="close-outline"></ion-icon>
        </div>
        <span class="themeName">关闭雪花</span>
      </div>
    </div>
  </div>

  <script src="./scripts/snow.js"></script>
  <script src="./scripts/themeToggle.js"></script>
  <script>
    const images = [
      { src: './png/two.png', caption: '温馨时刻' },
      { src: './png/wxr.png', caption: '幸福瞬间' },
      { src: './png/eat.png', caption: '美味时光' }
    ];
    
    let currentIndex = 0;
    let currentZoom = 1;

    function openLightbox(src, caption) {
      const lightbox = document.getElementById('lightbox');
      const img = document.getElementById('lightboxImage');
      const cap = document.getElementById('lightboxCaption');
      
      currentIndex = images.findIndex(item => item.src === src);
      
      img.src = src;
      cap.textContent = caption;
      lightbox.classList.add('active');
      document.body.style.overflow = 'hidden';
      
      currentZoom = 1;
      img.style.transform = `scale(${currentZoom})`;
      document.getElementById('zoomLevel').textContent = '100%';
    }

    function closeLightbox(event) {
      if (event.target.id === 'lightbox' || 
          event.target.closest('.lightboxClose')) {
        const lightbox = document.getElementById('lightbox');
        lightbox.classList.remove('active');
        document.body.style.overflow = '';
      }
    }

    function changeImage(direction, event) {
      event.stopPropagation();
      currentIndex += direction;
      
      if (currentIndex < 0) currentIndex = images.length - 1;
      if (currentIndex >= images.length) currentIndex = 0;
      
      const img = document.getElementById('lightboxImage');
      const cap = document.getElementById('lightboxCaption');
      
      img.style.opacity = '0';
      img.style.transform = `scale(0.8)`;
      
      setTimeout(() => {
        img.src = images[currentIndex].src;
        cap.textContent = images[currentIndex].caption;
        currentZoom = 1;
        img.style.opacity = '1';
        img.style.transform = `scale(${currentZoom})`;
        document.getElementById('zoomLevel').textContent = '100%';
      }, 200);
    }

    function zoomImage(delta, event) {
      event.stopPropagation();
      
      currentZoom += delta;
      currentZoom = Math.max(0.5, Math.min(3, currentZoom));
      
      const img = document.getElementById('lightboxImage');
      img.style.transform = `scale(${currentZoom})`;
      document.getElementById('zoomLevel').textContent = Math.round(currentZoom * 100) + '%';
    }

    function resetZoom(event) {
      event.stopPropagation();
      
      currentZoom = 1;
      const img = document.getElementById('lightboxImage');
      img.style.transform = `scale(${currentZoom})`;
      document.getElementById('zoomLevel').textContent = '100%';
    }

    document.addEventListener('keydown', (e) => {
      const lightbox = document.getElementById('lightbox');
      if (!lightbox.classList.contains('active')) return;
      
      switch(e.key) {
        case 'Escape':
          lightbox.classList.remove('active');
          document.body.style.overflow = '';
          break;
        case 'ArrowLeft':
          changeImage(-1, e);
          break;
        case 'ArrowRight':
          changeImage(1, e);
          break;
        case '+':
        case '=':
          zoomImage(0.2, e);
          break;
        case '-':
          zoomImage(-0.2, e);
          break;
      }
    });
  </script>
</body>
</html>